(function(){function e(e,t,n){var r=CKEDITOR.cleanWord;if(r)n();else{var i=CKEDITOR.getUrl(e.config.pasteFromWordCleanupFile||t+"filter/default.js");CKEDITOR.scriptLoader.load(i,n,null,true)}return!r}function t(e){e.data.type="html"}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"pastefromword,pastefromword-rtl",hidpi:true,init:function(n){function o(e){e&&e.removeListener();n.removeListener("beforePaste",t);i&&setTimeout(function(){i=0},0)}var r="pastefromword",i=0,s=this.path;n.addCommand(r,{canUndo:false,async:true,exec:function(e){var n=this;i=1;e.once("beforePaste",t);e.getClipboardData({title:e.lang.pastefromword.title},function(t){t&&e.fire("paste",{type:"html",dataValue:t.dataValue});e.fire("afterCommandExec",{name:r,command:n,returnValue:!!t})})}});n.ui.addButton&&n.ui.addButton("PasteFromWord",{label:n.lang.pastefromword.toolbar,command:r,toolbar:"clipboard,50"});n.on("pasteState",function(e){n.getCommand(r).setState(e.data)});n.on("paste",function(t){var r=t.data,o=r.dataValue;if(o&&(i||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(o))){var u=e(n,s,function(){if(u)n.fire("paste",r);else if(!n.config.pasteFromWordPromptCleanup||i||confirm(n.lang.pastefromword.confirmCleanup))r.dataValue=CKEDITOR.cleanWord(o,n)});u&&t.cancel()}},null,null,3)}})})()